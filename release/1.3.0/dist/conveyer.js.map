{"version":3,"file":"conveyer.js","sources":["../src/browser.ts","../src/cfcs/reactive/const.ts","../src/cfcs/reactive/Observer.ts","../src/cfcs/core/utils.ts","../src/cfcs/reactive/utils.ts","../src/cfcs/dom/utils.ts","../src/utils.ts","../src/Conveyer.ts","../src/consts.ts","../src/reactive.ts","../src/index.ts","../src/index.umd.ts"],"sourcesContent":["/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nexport const IS_IE = /msie|trident/g.test(\n  (typeof window !== \"undefined\" && window?.navigator?.userAgent?.toLowerCase()) || \"\",\n);\n","export const OBSERVERS_PATH = \"__observers__\";\nexport const REACTIVE_PATH = \"__reactive__\";\n","import Component from \"@egjs/component\";\n\ninterface EmitterEvents<Value> {\n  update: (value: Value) => void;\n}\n\nexport class Observer<Value> {\n  private _current: Value;\n  private _emitter = new Component<EmitterEvents<Value>>();\n\n  constructor(value?: Value) {\n    this._current = value as any;\n  }\n  public get current() {\n    return this._current as Value;\n  }\n  public set current(value: Value) {\n    const isUpdate = value !== this._current;\n    this._current = value;\n\n    if (isUpdate) {\n      this._emitter.trigger(\"update\", value);\n    }\n  }\n  public subscribe(callback: (value: Value) => void) {\n    this._emitter.on(\"update\", callback);\n  }\n  public unsubscribe(callback?: (value: Value) => void) {\n    this._emitter.off(\"update\", callback);\n  }\n}\n","\nexport function keys<T extends Record<string, any>>(obj: T): Array<keyof T> {\n  return Object.keys(obj);\n}\n\nexport function camelize(str: string) {\n  return str.replace(/[\\s-_]([a-z])/g, (all, letter) => letter.toUpperCase());\n}\n","import { OBSERVERS_PATH } from \"./const\";\nimport { Observer } from \"./Observer\";\nimport { ReactiveMethods } from \"./types\";\nimport { keys, Ref } from \"../core\";\n\nexport function withReactiveMethods<\n  Instance,\n  Names extends keyof Partial<Instance>,\n  Return extends ReactiveMethods<Instance, Names>\n>(ref: Ref<Instance>, methods: readonly Names[]): Return {\n  const obj: Record<any, any> = {};\n\n  methods.forEach(name => {\n    obj[name] = function (...args: any[]) {\n      const current: any = ref.current || ref.value;\n\n      return current[name](...args);\n    };\n  });\n  return obj as Return;\n}\n\n\nexport function getObservers(instance: any): Record<string, Observer<any>> {\n  if (!instance[OBSERVERS_PATH]) {\n    instance[OBSERVERS_PATH] = {};\n  }\n  return instance[OBSERVERS_PATH];\n}\n\nexport function getObserver(instance: any, name: string, defaultValue?: any): Observer<any> {\n  const observers = getObservers(instance);\n\n  if (!observers[name]) {\n    observers[name] = new Observer(defaultValue);\n  }\n  return observers[name];\n}\n\nexport function Reactive(name?: string) {\n  return function (prototype: any, memberName: string) {\n    const publicName = name || memberName;\n\n    Object.defineProperty(prototype, memberName, {\n      get: function () {\n        return getObserver(this, publicName).current;\n      },\n      set: function (value: any) {\n        getObserver(this, publicName, value).current = value;\n      },\n    });\n    if (publicName !== memberName) {\n      Object.defineProperty(prototype, publicName, {\n        get: function () {\n          return getObserver(this, publicName).current;\n        },\n      });\n    }\n  };\n}\n\nexport function ReactiveSubscribe(Constructor: any) {\n  const prototype = Constructor.prototype;\n\n  prototype[\"subscribe\"] = function (name: string, callback: (value: any) => void) {\n    if (!(name in this)) {\n      return;\n    }\n    getObserver(this, name).subscribe(callback);\n  };\n  prototype[\"unsubscribe\"] = function (name?: string, callback?: (value: any) => void) {\n    if (!name) {\n      keys(getObservers(this)).forEach((observerName) => {\n        this.unsubscribe(observerName);\n      });\n      return;\n    }\n    if (!(name in this)) {\n      return;\n    }\n    getObserver(this, name).unsubscribe(callback);\n  };\n}\n\nexport interface ReactiveSubscribe<Properties extends Record<string, any>> {\n  subscribe<Name extends keyof Properties = keyof Properties>(\n    name: Name, callback: (value: Properties[Name]) => void): void;\n  unsubscribe<Name extends keyof Properties = keyof Properties>(\n    name?: Name, callback?: (value: Properties[Name]) => void): void;\n}\n","\nexport function withClassMethods(methods: readonly string[]) {\n  return function (prototype: any, memberName: string) {\n    methods.forEach((name: string) => {\n      if (name in prototype) {\n        return;\n      }\n      prototype[name] = function (...args) {\n        const result = this[memberName][name](...args);\n\n        // fix `this` type to return your own `class` instance to the instance using the decorator.\n        if (result === this[memberName]) {\n          return this;\n        } else {\n          return result;\n        }\n      };\n    });\n  };\n}\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nexport function isString(val: any): val is string {\n  return typeof val === \"string\";\n}\n\nexport function findIndex<T>(arr: T[], callback: (element: T, index: number) => boolean) {\n  const length = arr.length;\n\n  for (let i = 0; i < length; ++i) {\n    if (callback(arr[i], i)) {\n      return i;\n    }\n  }\n  return -1;\n}\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nimport Axes, { OnChange, OnHold, PanInput, WheelInput } from \"@egjs/axes\";\nimport Component from \"@egjs/component\";\nimport { IS_IE } from \"./browser\";\nimport { ReactiveSubscribe, Reactive, Ref } from \"./cfcs\";\nimport {\n  ConveyerEvents, ConveyerItem,\n  ConveyerOptions, FindItemOptions, ConveyerReactiveState,\n  ScrollIntoViewOptions,\n} from \"./types\";\nimport { isString } from \"./utils\";\n\n\n/**\n * Conveyer adds Drag gestures to your Native Scroll.\n * @ko Conveyer는 네이티브 스크롤에 드래그 제스처를 추가합니다.\n * @extends Component\n * @support {\"ie\": \"9+(with polyfill)\", \"ch\" : \"latest\", \"ff\" : \"latest\",  \"sf\" : \"latest\", \"edge\" : \"latest\", \"ios\" : \"7+\", \"an\" : \"4.X+\"}\n * @example\n```html\n<div class=\"items\">\n  <div class=\"item\"></div>\n  <div class=\"item\"></div>\n  <div class=\"item\"></div>\n</div>\n<script>\nimport Conveyer from \"@egjs/conveyer\";\n\nconst conveyer = new Conveyer(\".items\");\n</script>\n```\n */\n@ReactiveSubscribe\nclass Conveyer extends Component<ConveyerEvents> {\n  protected _scrollAreaElement: HTMLElement;\n  protected _axes: Axes;\n  protected _items: ConveyerItem[] = [];\n  protected _size = 0;\n  protected _scrollSize = 0;\n  protected _options: ConveyerOptions;\n\n  private _scrollTimer = 0;\n  private _isDragScroll = false;\n  private _isAnimation = false;\n  private _scrollArea: string | HTMLElement | Ref<HTMLElement>;\n\n  /**\n   * Whether the scroll has reached the start.\n   * @ko 스크롤이 시작에 닿았는지 여부.\n   * @name Conveyer#isReachStart\n   * @type {boolean}\n   * @default false\n   * @readonly\n   * @example\n   * ```js\n   * import { Conveyer } from \"@egjs/conveyer\";\n   *\n   * const conveyer = new Conveyer(\".container\");\n   *\n   * conveyer.isReachStart\n   * ```\n   */\n  @Reactive(\"isReachStart\") private _isReachStart = false;\n  /**\n   * Whether the scroll has reached the end.\n   * @ko 스크롤이 끝에 닿았는지 여부.\n   * @name Conveyer#isReachEnd\n   * @type {boolean}\n   * @default false\n   * @readonly\n   * @example\n   * ```js\n   * import { Conveyer } from \"@egjs/conveyer\";\n   *\n   * const conveyer = new Conveyer(\".container\");\n   *\n   * conveyer.isReachEnd\n   * ```\n   */\n  @Reactive(\"isReachEnd\") private _isReachEnd = false;\n  /**\n   * the scroll position of the container\n   * @ko 컨테이너의 스크롤 위치\n   * @name Conveyer#scrollPos\n   * @type {number}\n   * @default 0\n   * @readonly\n   * @example\n   * ```js\n   * import { Conveyer } from \"@egjs/conveyer\";\n   *\n   * const conveyer = new Conveyer(\".container\");\n   *\n   * conveyer.scrollPos\n   * ```\n   */\n  @Reactive(\"scrollPos\") protected _pos = 0;\n  /**\n   * @param - A base element for a module <ko>모듈을 적용할 기준 엘리먼트</ko>\n   * @param - The option object of the InfiniteGrid module <ko>eg.InfiniteGrid 모듈의 옵션 객체</ko>\n   */\n  constructor(scrollArea: string | HTMLElement | Ref<HTMLElement>, options: ConveyerOptions = {}) {\n    super();\n    this._options = {\n      horizontal: true,\n      useDrag: true,\n      useSideWheel: true,\n      autoInit: true,\n      scrollDebounce: 100,\n      ...options,\n    };\n\n    this._scrollArea = scrollArea;\n    if (this._options.autoInit) {\n      this.init();\n    }\n  }\n  /**\n   * Finds an element for that direction.\n   * @ko 해당 방향에 대해 엘리먼트를 찾는다.]\n   * @see {@link /docs/examples/Methods direction's example} page for detailed information\n   * @param - direction of the element. \"start\" and \"end\" find inside. \"prev\" and \"next\" find outside. <ko>엘리먼트의 방향. \"start\", \"end\"는 안쪽으로 찾는다. \"prev\", \"next\"는 바깥쪽으로 찾는다.</ko>\n   * @param - Options for the `findElement` method. <ko>findElement 메서드의 옵션</ko>\n   * @example\n   * <p align=\"center\">\n   *  <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView1.png\" height=\"200\" />\n   * </p>\n   * <p align=\"center\">\n   *   <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView2.png\" height=\"210\" />\n   * </p>\n   */\n  public findElement(direction: \"start\" | \"end\" | \"prev\" | \"next\", options: FindItemOptions = {}) {\n    return this.findItem(direction, options)?.element || null;\n  }\n  /**\n   * Finds an item for an element or its direction.\n   * @ko 엘리먼트 또는 해당 방향에 대해 아이템을 찾는다.\n   * @see {@link /docs/examples/Methods direction's example} page for detailed information\n   * @param - direction of the element. \"start\" and \"end\" find inside. \"prev\" and \"next\" find outside. <ko>엘리먼트의 방향. \"start\", \"end\"는 안쪽으로 찾는다. \"prev\", \"next\"는 바깥쪽으로 찾는다.</ko>\n   * @param - Options for the `findItem` method. <ko>`findItem` 메서드의 옵션</ko>\n   * @example\n   * <p align=\"center\">\n   *  <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView1.png\" height=\"200\" />\n   * </p>\n   * <p align=\"center\">\n   *   <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView2.png\" height=\"210\" />\n   * </p>\n   */\n  public findItem(\n    target: HTMLElement | \"start\" | \"end\" | \"prev\" | \"next\",\n    options: FindItemOptions = {},\n  ): ConveyerItem | null {\n    const pos = this._pos;\n    const scrollSize = this._scrollSize;\n    const size = this._size;\n    const hitTest = options?.hitTest ?? 1;\n    const items = [...this._items];\n    const length = items.length;\n    const endPos = pos + size;\n    const sibling = options.sibling;\n    const startVirtualItem = { pos: 0, size: 0 };\n    const endVirtualItem = { pos: scrollSize, size: 0 };\n\n    if (items[0].pos > 0) {\n      items.unshift(startVirtualItem);\n    }\n    if (length && items[length - 1].pos + items[length - 1].size < scrollSize) {\n      items.push(endVirtualItem);\n    }\n    let selectedItem: ConveyerItem | undefined;\n\n\n    if (target === \"start\") {\n      if (pos < 0) {\n        return null;\n      }\n      const selectedItems = [...items].reverse().filter(item => {\n        const itemSize = item.size;\n        const dist = item.pos - pos;\n        const dist2 = dist + itemSize;\n\n        return (dist >= 0) || (dist2 >= 0 && (!itemSize || Math.abs(dist2) / itemSize >= hitTest));\n      }).reverse();\n\n      selectedItem = (selectedItems[0] === startVirtualItem && selectedItems[1]) || selectedItems[0];\n    } else if (target === \"end\") {\n      if (pos > scrollSize - size) {\n        return null;\n      }\n      const selectedItems = items.filter(item => {\n        const itemSize = item.size;\n        const dist = item.pos + itemSize - endPos;\n        const dist2 = dist - itemSize;\n\n        return dist <= 0 || (dist2 <= 0 && (!itemSize || Math.abs(dist2) / itemSize >= hitTest));\n      }).reverse();\n\n      selectedItem = (selectedItems[0] === endVirtualItem && selectedItems[1]) || selectedItems[0];\n    } else if (target === \"prev\") {\n      selectedItem = items.filter(item => {\n        const itemSize = item.size;\n        const dist = item.pos + itemSize - pos;\n        const dist2 = dist - itemSize;\n\n        return dist <= 0 || (dist2 <= 0 && (!itemSize || Math.abs(dist2) / itemSize >= hitTest));\n      }).reverse()[0];\n    } else if (target === \"next\") {\n      selectedItem = items.reverse().filter(item => {\n        const itemSize = item.size;\n        const dist = item.pos - endPos;\n        const dist2 = dist + itemSize;\n\n        return dist >= 0 || (dist2 >= 0 && (!itemSize || Math.abs(dist2) / itemSize >= hitTest));\n      }).reverse()[0];\n    } else {\n      return this._getItem(target);\n    }\n    if (sibling && selectedItem) {\n      const selectedIndex = items.indexOf(selectedItem);\n\n      if (selectedIndex > -1) {\n        selectedItem = items[selectedIndex + sibling];\n      }\n    }\n    return selectedItem || null;\n  }\n  /**\n   * Scrolls an element or an item in that direction into the view.\n   * @ko 엘리먼트나 해당 방향에 있는 아이템을 뷰안으로 스크롤을 한다.\n   * @see {@link /docs/examples/Methods target's example} page for detailed information\n   * @param - direction of the element. \"start\" and \"end\" find inside. \"prev\" and \"next\" find outside. <ko>엘리먼트의 방향. \"start\", \"end\"는 안쪽으로 찾는다. \"prev\", \"next\"는 바깥쪽으로 찾는다.</ko>\n   * @param - Options for the `scrollIntoView` method. <ko>`scrollIntoView` 메서드의 옵션</ko>\n   * @example\n   * <p align=\"center\">\n   *  <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView1.png\" height=\"200\" />\n   * </p>\n   * <p align=\"center\">\n   *   <img src=\"https://naver.github.io/egjs-conveyer/img/scrollIntoView2.png\" height=\"210\" />\n   * </p>\n   */\n  public scrollIntoView(target: HTMLElement | \"start\" | \"end\" | \"prev\" | \"next\", options: ScrollIntoViewOptions = {}) {\n    let item = this.findItem(target, options);\n\n    if (!item) {\n      return;\n    }\n    const duration = options.duration || 0;\n    let nextScrollPos = this._getNextScrollPos(item, options);\n\n    if (isString(target) && options.excludeStand && nextScrollPos === this._pos) {\n      const selectedIndex = this._items.indexOf(item);\n\n      if (selectedIndex === -1) {\n        return;\n      }\n      const sibling = target === \"start\" || target === \"prev\" ? -1 : 1;\n      item = this._items[selectedIndex + sibling];\n\n      if (!item) {\n        return;\n      }\n      nextScrollPos = this._getNextScrollPos(item, options);\n    }\n\n    this.scrollBy(nextScrollPos - this._pos, duration);\n  }\n  /**\n   * Scrolls by the given position amount.\n   * @ko 주어진 위치 양만큼 스크롤한다.\n   * @param - Amount of position to scroll by. <ko>스크롤할 위치의 양.</ko>\n   * @param - Duration to scroll by that position. <ko>해당 위치만큼 스크롤하는 시간</ko>\n   */\n  public scrollBy(pos: number, duration = 0) {\n    this._axes.setBy({ scroll: -pos }, duration);\n  }\n  /**\n   * Scroll to the given position.\n   * @ko 주어진 위치로 스크롤한다.\n   * @param - Amount of position to scroll to. <ko>스크롤할 위치의 양.</ko>\n   * @param - Duration to scroll to that position. <ko>해당 위치로 스크롤하는 시간</ko>\n   */\n  public scrollTo(pos: number, duration = 0) {\n    this._axes.setBy({ scroll: this._pos - pos }, duration);\n  }\n  /**\n   * Set the items directly to the Conveyer.\n   * @ko Conveyer에 아이템들을 직접 설정한다.\n   * @param - Items to set on Conveyer <ko>Conveyer에 설정할 아이템들</ko>\n   */\n  public setItems(items: ConveyerItem[]) {\n    this._items = items;\n  }\n  /**\n   * Update the position and size information of items.\n   * @ko 아이템들의 포지션, 사이즈 정보를 업데이트 한다.\n   */\n  public updateItems() {\n    const scrollAreaElement = this._scrollAreaElement;\n    const itemSelector = this._options.itemSelector;\n    const itemElements = [].slice.call(\n      itemSelector ? scrollAreaElement.querySelectorAll(itemSelector) : scrollAreaElement.children,\n    );\n    this.setItems(itemElements.map((el) => this._getItem(el)));\n  }\n  /**\n   * Update container size and scroll size.\n   * @ko 컨테이너의 크기, 스크롤 사이즈를 업데이트 한다.\n   */\n  public updateContainer() {\n    const scrollAreaElement = this._scrollAreaElement;\n    const horizontal = this._options.horizontal;\n\n    const size = horizontal ? scrollAreaElement.clientWidth : scrollAreaElement.clientHeight;\n    let scrollSize = horizontal ? scrollAreaElement.scrollWidth : scrollAreaElement.scrollHeight;\n\n    // check decimal point\n    if (IS_IE && scrollSize === size + 1) {\n      const style = getComputedStyle(scrollAreaElement);\n      const boxSizing = style.boxSizing;\n      const borderSize = horizontal\n        ? (parseFloat(style.borderLeftWidth) || 0) + (parseFloat(style.borderRightWidth) || 0)\n        : (parseFloat(style.borderTopWidth) || 0) + (parseFloat(style.borderBottomWidth) || 0);\n      const cssSize = parseFloat(horizontal ? style.width : style.height) || 0;\n      const contentSize = cssSize - (boxSizing === \"border-box\" ? borderSize : 0);\n\n      // 0 < 0.5 && 0.5 < 1\n      if (size < contentSize && contentSize < size + 1) {\n        scrollSize = size;\n      }\n    }\n    this._size = size;\n    this._scrollSize = scrollSize;\n    this._refreshScroll();\n    this._onScroll();\n  }\n  /**\n   * Updating containers and items.\n   * @ko 컨테이너와 아이템들을 업데이트 한다.\n   * @method\n   */\n  public update = () => {\n    this.updateItems();\n    this.updateContainer();\n  }\n  /**\n   * If you use the autoInit option as false, you can initialize it directly through the init method.\n   * @ko autoInit 옵션을 false로 사용하는 경우 직접 init 메서드를 통해 초기화 할 수 있다.\n   */\n  public init() {\n    if (this._axes) {\n      return;\n    }\n\n    const scrollArea = this._scrollArea;\n    let el!: HTMLElement;\n\n    if (isString(scrollArea)) {\n      el = document.querySelector<HTMLElement>(scrollArea)!;\n    } else if (scrollArea instanceof Element) {\n      el = scrollArea;\n    } else if (\"value\" in scrollArea || \"current\" in scrollArea) {\n      el = scrollArea.value! || scrollArea.current!;\n    }\n\n    this._scrollAreaElement = el;\n    let isDrag = false;\n    const scrollAreaElement = this._scrollAreaElement;\n    const options = this._options;\n    const axes = new Axes({\n      scroll: {\n        range: [-Infinity, Infinity],\n      },\n    }, {\n      deceleration: 0.005,\n      round: 1,\n      nested: options.nested,\n    }, {\n      scroll: 0,\n    });\n    let isHold = false;\n\n    axes.on({\n      \"hold\": e => {\n        isHold = true;\n        isDrag = false;\n        const nativeEvent = this._getNativeEvent(e);\n\n        if (!nativeEvent) {\n          return;\n        }\n        if (options.preventDefault) {\n          nativeEvent.preventDefault();\n        }\n        if (options.preventClickOnDrag) {\n          this._disableClick();\n        }\n      },\n      \"change\": e => {\n        const nativeEvent = this._getNativeEvent(e);\n        if (nativeEvent && !isHold) {\n          return;\n        }\n        if (options.useSideWheel && this._isMixedWheel(nativeEvent)) {\n          return;\n        }\n        this._isDragScroll = !!nativeEvent && nativeEvent.type !== \"wheel\";\n        this._isAnimation = !!isHold;\n        isDrag = true;\n        const scroll = e.delta.scroll;\n\n        if (options.horizontal) {\n          scrollAreaElement.scrollLeft -= scroll;\n        } else {\n          scrollAreaElement.scrollTop -= scroll;\n        }\n        if (options.nested) {\n          this._checkNestedMove(nativeEvent);\n        }\n      },\n      \"release\": e => {\n        if (!isDrag) {\n          e.setTo({ ...e.depaPos }, 0);\n          this._enableClick();\n        }\n        isDrag = false;\n      },\n    });\n\n    this._axes = axes;\n    if (options.useDrag) {\n      axes.connect(options.horizontal ? [\"scroll\", \"\"] : [\"\", \"scroll\"], new PanInput(scrollAreaElement, {\n        inputType: [\"mouse\"],\n        touchAction: \"auto\",\n      }));\n    }\n    if (options.useSideWheel) {\n      axes.connect(options.horizontal ? [\"scroll\", \"\"] : [\"\", \"scroll\"], new WheelInput(scrollAreaElement, {\n        useNormalized: false,\n      }));\n    }\n    scrollAreaElement.addEventListener(\"scroll\", this._onScroll);\n    window.addEventListener(\"resize\", this.update);\n\n    this.update();\n  }\n  /**\n   * Releases the instnace and events.\n   * @ko 인스턴스와 이벤트를 해제한다.\n   */\n  public destroy() {\n    this._axes?.destroy();\n    this.unsubscribe();\n    this._scrollAreaElement?.removeEventListener(\"scroll\", this._onScroll);\n    window.removeEventListener(\"resize\", this.update);\n    this.off();\n  }\n  private _refreshScroll() {\n    const horizontal = this._options.horizontal;\n    const scrollAreaElement = this._scrollAreaElement;\n\n    this._pos = Math.min(\n      this._scrollSize - this._size,\n      horizontal ? scrollAreaElement.scrollLeft : scrollAreaElement.scrollTop,\n    );\n  }\n  private _getItem(element: HTMLElement): ConveyerItem {\n    const horizontal = this._options.horizontal;\n\n    return {\n      element,\n      pos: horizontal ? element.offsetLeft : element.offsetTop,\n      size: horizontal ? element.offsetWidth : element.offsetHeight,\n    };\n  }\n  private _getNativeEvent(e: OnHold | OnChange) {\n    return e?.inputEvent?.srcEvent ? e.inputEvent?.srcEvent : e?.inputEvent;\n  }\n  private _getNextScrollPos(item: ConveyerItem, options: ScrollIntoViewOptions) {\n    const size = this._size;\n    const align = options.align || \"start\";\n    const padding = options.offset || 0;\n    const itemPos = item!.pos;\n    const itemSize = item!.size;\n    let scrollPos = 0;\n\n    if (align === \"start\") {\n      scrollPos = itemPos - padding;\n    } else if (align === \"end\") {\n      scrollPos = itemPos + itemSize - size + padding;\n    } else if (align === \"center\") {\n      scrollPos = itemPos + itemSize / 2 - size / 2 + padding;\n    }\n    return scrollPos;\n  }\n  private _isMixedWheel(nativeEvent: any) {\n    return !!nativeEvent && nativeEvent?.type === \"wheel\" && nativeEvent?.deltaX && nativeEvent?.deltaY;\n  }\n  private _checkNestedMove(nativeEvent: any) {\n    if (this.isReachStart || this.isReachEnd) {\n      nativeEvent.__childrenAxesAlreadyChanged = false;\n    }\n  }\n  private _onScroll = (e?: any) => {\n    if (e) {\n      this._debounceScroll();\n    }\n    this._refreshScroll();\n\n    const size = this._size;\n    const scrollSize = this._scrollSize;\n    const pos = this._pos;\n\n    // enter start\n    if (pos <= 0 && this.isReachStart !== true) {\n      this._isReachStart = true;\n      /**\n       * This event is fired when scroll reach start.\n       * @ko 스크롤이 앞에 닿으면 발생하는 이벤트이다.\n       * @event Conveyer#reachStart\n       */\n      this.trigger(\"reachStart\");\n    } else if (pos > 0 && this.isReachStart !== false) {\n      this._isReachStart = false;\n      /**\n       * This event is fired when scroll leave start.\n       * @ko 스크롤이 앞에서 떠나면 발생하는 이벤트이다.\n       * @event Conveyer#leaveStart\n       */\n      this.trigger(\"leaveStart\");\n    }\n    // enter end\n    if (scrollSize - size - pos < 1 && this.isReachEnd !== true) {\n      this._isReachEnd = true;\n      /**\n       * This event is fired when scroll reach end.\n       * @ko 스크롤이 끝에 닿으면 발생하는 이벤트이다.\n       * @event Conveyer#reachEnd\n       */\n      this.trigger(\"reachEnd\");\n    } else if (!(scrollSize - size - pos < 1) && this.isReachEnd !== false) {\n      this._isReachEnd = false;\n      /**\n       * This event is fired when scroll leave end.\n       * @ko 스크롤이 끝에서 떠나면 발생하는 이벤트이다.\n       * @event Conveyer#leaveEnd\n       */\n      this.trigger(\"leaveEnd\");\n    }\n  }\n  private _onPreventClick = (e: Event) => {\n    e.stopPropagation();\n    e.preventDefault();\n    this._enableClick();\n  }\n  private _enableClick() {\n    window.removeEventListener(\"click\", this._onPreventClick, true);\n  }\n  private _disableClick() {\n    window.addEventListener(\"click\", this._onPreventClick, true);\n  }\n  private _debounceScroll() {\n    if (!this._scrollTimer) {\n      /**\n       * This event is fired when begin scroll.\n       * @ko 스크롤이 시작하면 발생하는 이벤트이다.\n       * @event Conveyer#beginScroll\n       */\n      this.trigger(\"beginScroll\");\n    }\n    window.clearTimeout(this._scrollTimer);\n    this._scrollTimer = window.setTimeout(() => {\n      this._scrollTimer = 0;\n      /**\n       * This event is fired when finish scroll.\n       * @ko 스크롤이 끝나면 발생하는 이벤트이다.\n       * @event Conveyer#finishScroll\n       * @param {OnFinishScroll} e - The object of data to be sent to an event <ko>이벤트에 전달되는 데이터 객체</ko>\n       */\n      this.trigger(\"finishScroll\", {\n        isDragScroll: this._isDragScroll,\n        isTrusted: this._isDragScroll || !this._isAnimation,\n      });\n\n      this._isDragScroll = false;\n      this._isAnimation = false;\n    }, this._options.scrollDebounce);\n  }\n}\n\n\ninterface Conveyer extends ConveyerReactiveState, ReactiveSubscribe<ConveyerReactiveState> { }\n\nexport default Conveyer;\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nexport const CONVEYER_METHODS = [\n  \"update\",\n  \"findElement\",\n  \"findItem\",\n  \"scrollBy\",\n  \"scrollTo\",\n  \"scrollIntoView\",\n  \"setItems\",\n  \"updateContainer\",\n  \"updateItems\",\n  \"init\",\n] as const;\n\nexport const CONVEYER_EVENTS = [\n  \"reachStart\",\n  \"reachEnd\",\n  \"leaveStart\",\n  \"leaveEnd\",\n  \"beginScroll\",\n  \"finishScroll\",\n] as const;\n\nexport const CONVEYER_REACTIVE_STATE = {\n  \"isReachStart\": false,\n  \"isReachEnd\": false,\n  \"scrollPos\": 0,\n} as const;\n\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nimport Conveyer from \"./Conveyer\";\nimport { CONVEYER_EVENTS, CONVEYER_METHODS, CONVEYER_REACTIVE_STATE } from \"./consts\";\nimport { ReactiveAdapter, Ref } from \"./cfcs\";\nimport { ConveyerEvents, ConveyerMethods, ConveyerOptions, ConveyerReactiveState } from \"./types\";\n\n\nexport interface ConveyerData {\n  container: Ref<HTMLElement>;\n  props: ConveyerOptions;\n}\n\nexport const REACTIVE_CONVEYER: ReactiveAdapter<\n  Conveyer,\n  ConveyerReactiveState,\n  keyof ConveyerMethods,\n  ConveyerData,\n  ConveyerEvents\n> = {\n  state: CONVEYER_REACTIVE_STATE,\n  methods: CONVEYER_METHODS,\n  events: CONVEYER_EVENTS,\n  instance(data) {\n    return new Conveyer(data.container, { ...data.props, autoInit: false });\n  },\n  init(instance, data) {\n    if (data.props.autoInit !== false) {\n      instance.init();\n    }\n  },\n  on(instance, name, callback) {\n    instance.on(name, callback);\n  },\n  off(instance, name, callback) {\n    instance.off(name, callback);\n  },\n  destroy(instance) {\n    instance.destroy();\n  },\n};\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nimport Conveyer from \"./Conveyer\";\n\nexport default Conveyer;\n\nexport * from \"./consts\";\nexport * from \"./types\";\nexport * from \"./reactive\";\nexport * from \"./cfcs\";\n","/**\n * egjs-conveyer\n * Copyright (c) 2022-present NAVER Corp.\n * MIT license\n */\nimport Conveyer, * as modules from \"./index\";\n\nfor (const name in modules) {\n  (Conveyer as any)[name] = (modules as any)[name];\n}\n\nexport default Conveyer;\n"],"names":["IS_IE","test","window","navigator","userAgent","toLowerCase","OBSERVERS_PATH","value","Component","_current","Object","isUpdate","_emitter","trigger","callback","on","off","keys","obj","camelize","str","replace","all","letter","toUpperCase","withReactiveMethods","ref","methods","forEach","name","_i","args","current","getObservers","instance","getObserver","defaultValue","observers","Observer","Reactive","prototype","memberName","publicName","defineProperty","get","set","ReactiveSubscribe","Constructor","subscribe","observerName","_this","unsubscribe","withClassMethods","result","_a","isString","val","__extends","scrollArea","options","_super","updateItems","updateContainer","e","_debounceScroll","_refreshScroll","size","_size","scrollSize","_scrollSize","pos","_pos","isReachStart","_isReachStart","isReachEnd","_isReachEnd","stopPropagation","preventDefault","_enableClick","_options","horizontal","useDrag","useSideWheel","autoInit","scrollDebounce","_scrollArea","init","direction","findItem","element","target","hitTest","items","_items","length","endPos","sibling","startVirtualItem","endVirtualItem","unshift","push","selectedItem","selectedItems","__spreadArray","reverse","filter","item","itemSize","dist","dist2","Math","abs","_getItem","selectedIndex","indexOf","duration","nextScrollPos","_getNextScrollPos","excludeStand","scrollBy","_axes","setBy","scroll","scrollAreaElement","_scrollAreaElement","itemSelector","itemElements","slice","call","querySelectorAll","children","setItems","map","el","clientWidth","clientHeight","scrollWidth","scrollHeight","style","getComputedStyle","boxSizing","borderSize","parseFloat","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","cssSize","width","height","contentSize","_onScroll","document","querySelector","Element","isDrag","axes","Axes","range","Infinity","deceleration","round","nested","isHold","nativeEvent","_getNativeEvent","preventClickOnDrag","_disableClick","_isMixedWheel","_isDragScroll","type","_isAnimation","delta","scrollLeft","scrollTop","_checkNestedMove","setTo","depaPos","connect","PanInput","inputType","touchAction","WheelInput","useNormalized","addEventListener","update","destroy","removeEventListener","min","offsetLeft","offsetTop","offsetWidth","offsetHeight","inputEvent","srcEvent","align","padding","offset","itemPos","scrollPos","deltaX","deltaY","__childrenAxesAlreadyChanged","_onPreventClick","_scrollTimer","clearTimeout","setTimeout","isDragScroll","isTrusted","__decorate","Conveyer","CONVEYER_METHODS","CONVEYER_EVENTS","CONVEYER_REACTIVE_STATE","REACTIVE_CONVEYER","state","events","data","container","props","modules"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;IAAA;;;;;;;AAKA,IAAO,IAAMA,KAAK,GAAG,gBAAgBC,IAAhB,CAClB,OAAOC,MAAP,KAAkB,WAAlB,KAAiC,MAAA,MAAAA,MAAM,SAAN,IAAAA,MAAM,WAAN,SAAA,GAAAA,MAAM,CAAEC,SAAR,UAAA,iBAAA,SAAA,MAAmBC,SAAnB,UAAA,iBAAA,SAAA,MAA8BC,aAA/D,CAAD,IAAkF,EAD/D,CAAd;;ICLA,IAAMC,cAAc,GAAG,eAAvB;;ICMP;;;IAIE,mBAAA,CAAYC,KAAZ;IAFQ,iBAAA,GAAW,IAAIC,SAAJ,EAAX;IAGN,SAAKC,QAAL,GAAgBF,KAAhB;IACD;;;IACDG,EAAAA,qBAAA,mBAAA;aAAA;IACE,aAAO,KAAKD,QAAZ;IACD;aACD,UAAmBF,KAAnB;IACE,UAAMI,QAAQ,GAAGJ,KAAK,KAAK,KAAKE,QAAhC;IACA,WAAKA,QAAL,GAAgBF,KAAhB;;IAEA,UAAII,QAAJ,EAAc;IACZ,aAAKC,QAAL,CAAcC,OAAd,CAAsB,QAAtB,EAAgCN,KAAhC;IACD;IACF;;;OAVD;;IAWO,mBAAA,GAAP,UAAiBO,QAAjB;IACE,SAAKF,QAAL,CAAcG,EAAd,CAAiB,QAAjB,EAA2BD,QAA3B;IACD,GAFM;;IAGA,qBAAA,GAAP,UAAmBA,QAAnB;IACE,SAAKF,QAAL,CAAcI,GAAd,CAAkB,QAAlB,EAA4BF,QAA5B;IACD,GAFM;;IAGT,iBAAA;IAAC,GAxBD;;aCLgBG,KAAoCC;IAClD,SAAOR,MAAM,CAACO,IAAP,CAAYC,GAAZ,CAAP;IACD;AAED,aAAgBC,SAASC;IACvB,SAAOA,GAAG,CAACC,OAAJ,CAAY,gBAAZ,EAA8B,UAACC,GAAD,EAAMC,MAAN;IAAiB,WAAAA,MAAM,CAACC,WAAP,EAAA;IAAoB,GAAnE,CAAP;IACD;;aCFeC,oBAIdC,KAAoBC;IACpB,MAAMT,GAAG,GAAqB,EAA9B;IAEAS,EAAAA,OAAO,CAACC,OAAR,CAAgB,UAAAC,IAAA;IACdX,IAAAA,GAAG,CAACW,IAAD,CAAH,GAAY;IAAU,mBAAA;;eAAA,YAAAC,uBAAAA;IAAAC,QAAAA,QAAA,gBAAA;;;IACpB,UAAMC,OAAO,GAAQN,GAAG,CAACM,OAAJ,IAAeN,GAAG,CAACnB,KAAxC;IAEA,aAAOyB,OAAO,CAACH,IAAD,CAAP,MAAA,CAAAG,OAAA,EAAiBD,IAAjB,CAAP;IACD,KAJD;IAKD,GAND;IAOA,SAAOb,GAAP;IACD;AAGD,aAAgBe,aAAaC;IAC3B,MAAI,CAACA,QAAQ,CAAC5B,cAAD,CAAb,EAA+B;IAC7B4B,IAAAA,QAAQ,CAAC5B,cAAD,CAAR,GAA2B,EAA3B;IACD;;IACD,SAAO4B,QAAQ,CAAC5B,cAAD,CAAf;IACD;AAED,aAAgB6B,YAAYD,UAAeL,MAAcO;IACvD,MAAMC,SAAS,GAAGJ,YAAY,CAACC,QAAD,CAA9B;;IAEA,MAAI,CAACG,SAAS,CAACR,IAAD,CAAd,EAAsB;IACpBQ,IAAAA,SAAS,CAACR,IAAD,CAAT,GAAkB,IAAIS,QAAJ,CAAaF,YAAb,CAAlB;IACD;;IACD,SAAOC,SAAS,CAACR,IAAD,CAAhB;IACD;AAED,aAAgBU,SAASV;IACvB,SAAO,UAAUW,SAAV,EAA0BC,UAA1B;IACL,QAAMC,UAAU,GAAGb,IAAI,IAAIY,UAA3B;IAEA/B,IAAAA,MAAM,CAACiC,cAAP,CAAsBH,SAAtB,EAAiCC,UAAjC,EAA6C;IAC3CG,MAAAA,GAAG,EAAE;IACH,eAAOT,WAAW,CAAC,IAAD,EAAOO,UAAP,CAAX,CAA8BV,OAArC;IACD,OAH0C;IAI3Ca,MAAAA,GAAG,EAAE,UAAUtC,KAAV;IACH4B,QAAAA,WAAW,CAAC,IAAD,EAAOO,UAAP,EAAmBnC,KAAnB,CAAX,CAAqCyB,OAArC,GAA+CzB,KAA/C;IACD;IAN0C,KAA7C;;IAQA,QAAImC,UAAU,KAAKD,UAAnB,EAA+B;IAC7B/B,MAAAA,MAAM,CAACiC,cAAP,CAAsBH,SAAtB,EAAiCE,UAAjC,EAA6C;IAC3CE,QAAAA,GAAG,EAAE;IACH,iBAAOT,WAAW,CAAC,IAAD,EAAOO,UAAP,CAAX,CAA8BV,OAArC;IACD;IAH0C,OAA7C;IAKD;IACF,GAlBD;IAmBD;AAED,aAAgBc,kBAAkBC;IAChC,MAAMP,SAAS,GAAGO,WAAW,CAACP,SAA9B;;IAEAA,EAAAA,SAAS,CAAC,WAAD,CAAT,GAAyB,UAAUX,IAAV,EAAwBf,QAAxB;IACvB,QAAI,EAAEe,IAAI,IAAI,IAAV,CAAJ,EAAqB;IACnB;IACD;;IACDM,IAAAA,WAAW,CAAC,IAAD,EAAON,IAAP,CAAX,CAAwBmB,SAAxB,CAAkClC,QAAlC;IACD,GALD;;IAMA0B,EAAAA,SAAS,CAAC,aAAD,CAAT,GAA2B,UAAUX,IAAV,EAAyBf,QAAzB;IAAA,oBAAA;;IACzB,QAAI,CAACe,IAAL,EAAW;IACTZ,MAAAA,IAAI,CAACgB,YAAY,CAAC,IAAD,CAAb,CAAJ,CAAyBL,OAAzB,CAAiC,UAACqB,YAAD;IAC/BC,QAAAA,KAAI,CAACC,WAAL,CAAiBF,YAAjB;IACD,OAFD;IAGA;IACD;;IACD,QAAI,EAAEpB,IAAI,IAAI,IAAV,CAAJ,EAAqB;IACnB;IACD;;IACDM,IAAAA,WAAW,CAAC,IAAD,EAAON,IAAP,CAAX,CAAwBsB,WAAxB,CAAoCrC,QAApC;IACD,GAXD;IAYD;;aCjFesC,iBAAiBzB;IAC/B,SAAO,UAAUa,SAAV,EAA0BC,UAA1B;IACLd,IAAAA,OAAO,CAACC,OAAR,CAAgB,UAACC,IAAD;IACd,UAAIA,IAAI,IAAIW,SAAZ,EAAuB;IACrB;IACD;;IACDA,MAAAA,SAAS,CAACX,IAAD,CAAT,GAAkB;;;IAAU,qBAAA;;iBAAA,YAAAC,uBAAAA;IAAAC,UAAAA,QAAA,gBAAA;;;IAC1B,YAAMsB,MAAM,GAAG,CAAAC,KAAA,KAAKb,UAAL,CAAA,EAAiBZ,IAAjB,OAAA,GAAA,EAA0BE,IAA1B,CAAf;;;IAGA,YAAIsB,MAAM,KAAK,KAAKZ,UAAL,CAAf,EAAiC;IAC/B,iBAAO,IAAP;IACD,SAFD,MAEO;IACL,iBAAOY,MAAP;IACD;IACF,OATD;IAUD,KAdD;IAeD,GAhBD;IAiBD;;ICnBD;;;;;AAKA,aAAgBE,SAASC;IACvB,SAAO,OAAOA,GAAP,KAAe,QAAtB;IACD;;ICUD;;;;;;;;;;;;;;;;;;;;IAoBA;;;IAAuBC,EAAAA,2BAAA;IAgErB;;;;;;IAIA,mBAAA,CAAYC,UAAZ,EAAiEC,OAAjE;IAAiE,0BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAAjE,gBACEC,WAAA,KAAA,SADF;;IAjEUV,IAAAA,YAAA,GAAyB,EAAzB;IACAA,IAAAA,WAAA,GAAQ,CAAR;IACAA,IAAAA,iBAAA,GAAc,CAAd;IAGFA,IAAAA,kBAAA,GAAe,CAAf;IACAA,IAAAA,mBAAA,GAAgB,KAAhB;IACAA,IAAAA,kBAAA,GAAe,KAAf;IAGR;;;;;;;;;;;;;;;;;IAgBkCA,IAAAA,mBAAA,GAAgB,KAAhB;IAClC;;;;;;;;;;;;;;;;;IAgBgCA,IAAAA,iBAAA,GAAc,KAAd;IAChC;;;;;;;;;;;;;;;;;IAgBiCA,IAAAA,UAAA,GAAO,CAAP;IA+OjC;;;;;;IAKOA,IAAAA,YAAA,GAAS;IACdA,MAAAA,KAAI,CAACW,WAAL;;IACAX,MAAAA,KAAI,CAACY,eAAL;IACD,KAHM;;IAkKCZ,IAAAA,eAAA,GAAY,UAACa,CAAD;IAClB,UAAIA,CAAJ,EAAO;IACLb,QAAAA,KAAI,CAACc,eAAL;IACD;;IACDd,MAAAA,KAAI,CAACe,cAAL;;IAEA,UAAMC,IAAI,GAAGhB,KAAI,CAACiB,KAAlB;IACA,UAAMC,UAAU,GAAGlB,KAAI,CAACmB,WAAxB;IACA,UAAMC,GAAG,GAAGpB,KAAI,CAACqB,IAAjB;;IAGA,UAAID,GAAG,IAAI,CAAP,IAAYpB,KAAI,CAACsB,YAAL,KAAsB,IAAtC,EAA4C;IAC1CtB,QAAAA,KAAI,CAACuB,aAAL,GAAqB,IAArB;IACA;;;;;;IAKAvB,QAAAA,KAAI,CAACrC,OAAL,CAAa,YAAb;IACD,OARD,MAQO,IAAIyD,GAAG,GAAG,CAAN,IAAWpB,KAAI,CAACsB,YAAL,KAAsB,KAArC,EAA4C;IACjDtB,QAAAA,KAAI,CAACuB,aAAL,GAAqB,KAArB;IACA;;;;;;IAKAvB,QAAAA,KAAI,CAACrC,OAAL,CAAa,YAAb;IACD;;;IAED,UAAIuD,UAAU,GAAGF,IAAb,GAAoBI,GAApB,GAA0B,CAA1B,IAA+BpB,KAAI,CAACwB,UAAL,KAAoB,IAAvD,EAA6D;IAC3DxB,QAAAA,KAAI,CAACyB,WAAL,GAAmB,IAAnB;IACA;;;;;;IAKAzB,QAAAA,KAAI,CAACrC,OAAL,CAAa,UAAb;IACD,OARD,MAQO,IAAI,EAAEuD,UAAU,GAAGF,IAAb,GAAoBI,GAApB,GAA0B,CAA5B,KAAkCpB,KAAI,CAACwB,UAAL,KAAoB,KAA1D,EAAiE;IACtExB,QAAAA,KAAI,CAACyB,WAAL,GAAmB,KAAnB;IACA;;;;;;IAKAzB,QAAAA,KAAI,CAACrC,OAAL,CAAa,UAAb;IACD;IACF,KA9CO;;IA+CAqC,IAAAA,qBAAA,GAAkB,UAACa,CAAD;IACxBA,MAAAA,CAAC,CAACa,eAAF;IACAb,MAAAA,CAAC,CAACc,cAAF;;IACA3B,MAAAA,KAAI,CAAC4B,YAAL;IACD,KAJO;;IA9bN5B,IAAAA,KAAI,CAAC6B,QAAL;IACEC,MAAAA,UAAU,EAAE;IACZC,MAAAA,OAAO,EAAE;IACTC,MAAAA,YAAY,EAAE;IACdC,MAAAA,QAAQ,EAAE;IACVC,MAAAA,cAAc,EAAE;WACbzB,QANL;IASAT,IAAAA,KAAI,CAACmC,WAAL,GAAmB3B,UAAnB;;IACA,QAAIR,KAAI,CAAC6B,QAAL,CAAcI,QAAlB,EAA4B;IAC1BjC,MAAAA,KAAI,CAACoC,IAAL;IACD;;;IACF;IACD;;;;;;;;;;;;;;;;;;IAcO,qBAAA,GAAP,UAAmBC,SAAnB,EAAiE5B,OAAjE;;;IAAiE,0BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAC/D,WAAO,CAAA,MAAA,KAAK6B,QAAL,CAAcD,SAAd,EAAyB5B,OAAzB,CAAA,UAAA,iBAAA,SAAA,MAAmC8B,OAAnC,KAA8C,IAArD;IACD,GAFM;IAGP;;;;;;;;;;;;;;;;IAcO,kBAAA,GAAP,UACEC,MADF,EAEE/B,OAFF;;;IAEE,0BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAEA,QAAMW,GAAG,GAAG,KAAKC,IAAjB;IACA,QAAMH,UAAU,GAAG,KAAKC,WAAxB;IACA,QAAMH,IAAI,GAAG,KAAKC,KAAlB;IACA,QAAMwB,OAAO,GAAG,MAAAhC,OAAO,SAAP,IAAAA,OAAO,WAAP,SAAA,GAAAA,OAAO,CAAEgC,OAAT,UAAA,iBAAA,KAAA,GAAoB,CAApC;;IACA,QAAMC,KAAK,qBAAO,KAAKC,aAAvB;;IACA,QAAMC,MAAM,GAAGF,KAAK,CAACE,MAArB;IACA,QAAMC,MAAM,GAAGzB,GAAG,GAAGJ,IAArB;IACA,QAAM8B,OAAO,GAAGrC,OAAO,CAACqC,OAAxB;IACA,QAAMC,gBAAgB,GAAG;IAAE3B,MAAAA,GAAG,EAAE,CAAP;IAAUJ,MAAAA,IAAI,EAAE;IAAhB,KAAzB;IACA,QAAMgC,cAAc,GAAG;IAAE5B,MAAAA,GAAG,EAAEF,UAAP;IAAmBF,MAAAA,IAAI,EAAE;IAAzB,KAAvB;;IAEA,QAAI0B,KAAK,CAAC,CAAD,CAAL,CAAStB,GAAT,GAAe,CAAnB,EAAsB;IACpBsB,MAAAA,KAAK,CAACO,OAAN,CAAcF,gBAAd;IACD;;IACD,QAAIH,MAAM,IAAIF,KAAK,CAACE,MAAM,GAAG,CAAV,CAAL,CAAkBxB,GAAlB,GAAwBsB,KAAK,CAACE,MAAM,GAAG,CAAV,CAAL,CAAkB5B,IAA1C,GAAiDE,UAA/D,EAA2E;IACzEwB,MAAAA,KAAK,CAACQ,IAAN,CAAWF,cAAX;IACD;;IACD,QAAIG,YAAJ;;IAGA,QAAIX,MAAM,KAAK,OAAf,EAAwB;IACtB,UAAIpB,GAAG,GAAG,CAAV,EAAa;IACX,eAAO,IAAP;IACD;;IACD,UAAMgC,aAAa,GAAGC,kBAAIX,YAAJ,CAAWY,OAAX,GAAqBC,MAArB,CAA4B,UAAAC,IAAA;IAChD,YAAMC,QAAQ,GAAGD,IAAI,CAACxC,IAAtB;IACA,YAAM0C,IAAI,GAAGF,IAAI,CAACpC,GAAL,GAAWA,GAAxB;IACA,YAAMuC,KAAK,GAAGD,IAAI,GAAGD,QAArB;IAEA,eAAQC,IAAI,IAAI,CAAT,IAAgBC,KAAK,IAAI,CAAT,KAAe,CAACF,QAAD,IAAaG,IAAI,CAACC,GAAL,CAASF,KAAT,IAAkBF,QAAlB,IAA8BhB,OAA1D,CAAvB;IACD,OANqB,EAMnBa,OANmB,EAAtB;;IAQAH,MAAAA,YAAY,GAAIC,aAAa,CAAC,CAAD,CAAb,KAAqBL,gBAArB,IAAyCK,aAAa,CAAC,CAAD,CAAvD,IAA+DA,aAAa,CAAC,CAAD,CAA3F;IACD,KAbD,MAaO,IAAIZ,MAAM,KAAK,KAAf,EAAsB;IAC3B,UAAIpB,GAAG,GAAGF,UAAU,GAAGF,IAAvB,EAA6B;IAC3B,eAAO,IAAP;IACD;;IACD,UAAMoC,aAAa,GAAGV,KAAK,CAACa,MAAN,CAAa,UAAAC,IAAA;IACjC,YAAMC,QAAQ,GAAGD,IAAI,CAACxC,IAAtB;IACA,YAAM0C,IAAI,GAAGF,IAAI,CAACpC,GAAL,GAAWqC,QAAX,GAAsBZ,MAAnC;IACA,YAAMc,KAAK,GAAGD,IAAI,GAAGD,QAArB;IAEA,eAAOC,IAAI,IAAI,CAAR,IAAcC,KAAK,IAAI,CAAT,KAAe,CAACF,QAAD,IAAaG,IAAI,CAACC,GAAL,CAASF,KAAT,IAAkBF,QAAlB,IAA8BhB,OAA1D,CAArB;IACD,OANqB,EAMnBa,OANmB,EAAtB;IAQAH,MAAAA,YAAY,GAAIC,aAAa,CAAC,CAAD,CAAb,KAAqBJ,cAArB,IAAuCI,aAAa,CAAC,CAAD,CAArD,IAA6DA,aAAa,CAAC,CAAD,CAAzF;IACD,KAbM,MAaA,IAAIZ,MAAM,KAAK,MAAf,EAAuB;IAC5BW,MAAAA,YAAY,GAAGT,KAAK,CAACa,MAAN,CAAa,UAAAC,IAAA;IAC1B,YAAMC,QAAQ,GAAGD,IAAI,CAACxC,IAAtB;IACA,YAAM0C,IAAI,GAAGF,IAAI,CAACpC,GAAL,GAAWqC,QAAX,GAAsBrC,GAAnC;IACA,YAAMuC,KAAK,GAAGD,IAAI,GAAGD,QAArB;IAEA,eAAOC,IAAI,IAAI,CAAR,IAAcC,KAAK,IAAI,CAAT,KAAe,CAACF,QAAD,IAAaG,IAAI,CAACC,GAAL,CAASF,KAAT,IAAkBF,QAAlB,IAA8BhB,OAA1D,CAArB;IACD,OANc,EAMZa,OANY,GAMF,CANE,CAAf;IAOD,KARM,MAQA,IAAId,MAAM,KAAK,MAAf,EAAuB;IAC5BW,MAAAA,YAAY,GAAGT,KAAK,CAACY,OAAN,GAAgBC,MAAhB,CAAuB,UAAAC,IAAA;IACpC,YAAMC,QAAQ,GAAGD,IAAI,CAACxC,IAAtB;IACA,YAAM0C,IAAI,GAAGF,IAAI,CAACpC,GAAL,GAAWyB,MAAxB;IACA,YAAMc,KAAK,GAAGD,IAAI,GAAGD,QAArB;IAEA,eAAOC,IAAI,IAAI,CAAR,IAAcC,KAAK,IAAI,CAAT,KAAe,CAACF,QAAD,IAAaG,IAAI,CAACC,GAAL,CAASF,KAAT,IAAkBF,QAAlB,IAA8BhB,OAA1D,CAArB;IACD,OANc,EAMZa,OANY,GAMF,CANE,CAAf;IAOD,KARM,MAQA;IACL,aAAO,KAAKQ,QAAL,CAActB,MAAd,CAAP;IACD;;IACD,QAAIM,OAAO,IAAIK,YAAf,EAA6B;IAC3B,UAAMY,aAAa,GAAGrB,KAAK,CAACsB,OAAN,CAAcb,YAAd,CAAtB;;IAEA,UAAIY,aAAa,GAAG,CAAC,CAArB,EAAwB;IACtBZ,QAAAA,YAAY,GAAGT,KAAK,CAACqB,aAAa,GAAGjB,OAAjB,CAApB;IACD;IACF;;IACD,WAAOK,YAAY,IAAI,IAAvB;IACD,GA7EM;IA8EP;;;;;;;;;;;;;;;;IAcO,wBAAA,GAAP,UAAsBX,MAAtB,EAA+E/B,OAA/E;IAA+E,0BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAC7E,QAAI+C,IAAI,GAAG,KAAKlB,QAAL,CAAcE,MAAd,EAAsB/B,OAAtB,CAAX;;IAEA,QAAI,CAAC+C,IAAL,EAAW;IACT;IACD;;IACD,QAAMS,QAAQ,GAAGxD,OAAO,CAACwD,QAAR,IAAoB,CAArC;;IACA,QAAIC,aAAa,GAAG,KAAKC,iBAAL,CAAuBX,IAAvB,EAA6B/C,OAA7B,CAApB;;IAEA,QAAIJ,QAAQ,CAACmC,MAAD,CAAR,IAAoB/B,OAAO,CAAC2D,YAA5B,IAA4CF,aAAa,KAAK,KAAK7C,IAAvE,EAA6E;IAC3E,UAAM0C,aAAa,GAAG,KAAKpB,MAAL,CAAYqB,OAAZ,CAAoBR,IAApB,CAAtB;;IAEA,UAAIO,aAAa,KAAK,CAAC,CAAvB,EAA0B;IACxB;IACD;;IACD,UAAMjB,OAAO,GAAGN,MAAM,KAAK,OAAX,IAAsBA,MAAM,KAAK,MAAjC,GAA0C,CAAC,CAA3C,GAA+C,CAA/D;IACAgB,MAAAA,IAAI,GAAG,KAAKb,MAAL,CAAYoB,aAAa,GAAGjB,OAA5B,CAAP;;IAEA,UAAI,CAACU,IAAL,EAAW;IACT;IACD;;IACDU,MAAAA,aAAa,GAAG,KAAKC,iBAAL,CAAuBX,IAAvB,EAA6B/C,OAA7B,CAAhB;IACD;;IAED,SAAK4D,QAAL,CAAcH,aAAa,GAAG,KAAK7C,IAAnC,EAAyC4C,QAAzC;IACD,GAzBM;IA0BP;;;;;;;;IAMO,kBAAA,GAAP,UAAgB7C,GAAhB,EAA6B6C,QAA7B;IAA6B,2BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAC3B,SAAKK,KAAL,CAAWC,KAAX,CAAiB;IAAEC,MAAAA,MAAM,EAAE,CAACpD;IAAX,KAAjB,EAAmC6C,QAAnC;IACD,GAFM;IAGP;;;;;;;;IAMO,kBAAA,GAAP,UAAgB7C,GAAhB,EAA6B6C,QAA7B;IAA6B,2BAAA,EAAA;IAAAA,MAAAA,YAAA;;;IAC3B,SAAKK,KAAL,CAAWC,KAAX,CAAiB;IAAEC,MAAAA,MAAM,EAAE,KAAKnD,IAAL,GAAYD;IAAtB,KAAjB,EAA8C6C,QAA9C;IACD,GAFM;IAGP;;;;;;;IAKO,kBAAA,GAAP,UAAgBvB,KAAhB;IACE,SAAKC,MAAL,GAAcD,KAAd;IACD,GAFM;IAGP;;;;;;IAIO,qBAAA,GAAP;IAAA,oBAAA;;IACE,QAAM+B,iBAAiB,GAAG,KAAKC,kBAA/B;IACA,QAAMC,YAAY,GAAG,KAAK9C,QAAL,CAAc8C,YAAnC;IACA,QAAMC,YAAY,GAAG,GAAGC,KAAH,CAASC,IAAT,CACnBH,YAAY,GAAGF,iBAAiB,CAACM,gBAAlB,CAAmCJ,YAAnC,CAAH,GAAsDF,iBAAiB,CAACO,QADjE,CAArB;IAGA,SAAKC,QAAL,CAAcL,YAAY,CAACM,GAAb,CAAiB,UAACC,EAAD;IAAQ,aAAAnF,KAAI,CAAC8D,QAAL,CAAcqB,EAAd,CAAA;IAAiB,KAA1C,CAAd;IACD,GAPM;IAQP;;;;;;IAIO,yBAAA,GAAP;IACE,QAAMV,iBAAiB,GAAG,KAAKC,kBAA/B;IACA,QAAM5C,UAAU,GAAG,KAAKD,QAAL,CAAcC,UAAjC;IAEA,QAAMd,IAAI,GAAGc,UAAU,GAAG2C,iBAAiB,CAACW,WAArB,GAAmCX,iBAAiB,CAACY,YAA5E;IACA,QAAInE,UAAU,GAAGY,UAAU,GAAG2C,iBAAiB,CAACa,WAArB,GAAmCb,iBAAiB,CAACc,YAAhF;;IAGA,QAAIzI,KAAK,IAAIoE,UAAU,KAAKF,IAAI,GAAG,CAAnC,EAAsC;IACpC,UAAMwE,KAAK,GAAGC,gBAAgB,CAAChB,iBAAD,CAA9B;IACA,UAAMiB,SAAS,GAAGF,KAAK,CAACE,SAAxB;IACA,UAAMC,UAAU,GAAG7D,UAAU,GACzB,CAAC8D,UAAU,CAACJ,KAAK,CAACK,eAAP,CAAV,IAAqC,CAAtC,KAA4CD,UAAU,CAACJ,KAAK,CAACM,gBAAP,CAAV,IAAsC,CAAlF,CADyB,GAEzB,CAACF,UAAU,CAACJ,KAAK,CAACO,cAAP,CAAV,IAAoC,CAArC,KAA2CH,UAAU,CAACJ,KAAK,CAACQ,iBAAP,CAAV,IAAuC,CAAlF,CAFJ;IAGA,UAAMC,OAAO,GAAGL,UAAU,CAAC9D,UAAU,GAAG0D,KAAK,CAACU,KAAT,GAAiBV,KAAK,CAACW,MAAlC,CAAV,IAAuD,CAAvE;IACA,UAAMC,WAAW,GAAGH,OAAO,IAAIP,SAAS,KAAK,YAAd,GAA6BC,UAA7B,GAA0C,CAA9C,CAA3B,CAPoC;;IAUpC,UAAI3E,IAAI,GAAGoF,WAAP,IAAsBA,WAAW,GAAGpF,IAAI,GAAG,CAA/C,EAAkD;IAChDE,QAAAA,UAAU,GAAGF,IAAb;IACD;IACF;;IACD,SAAKC,KAAL,GAAaD,IAAb;IACA,SAAKG,WAAL,GAAmBD,UAAnB;;IACA,SAAKH,cAAL;;IACA,SAAKsF,SAAL;IACD,GA1BM;IAoCP;;;;;;IAIO,cAAA,GAAP;IAAA,oBAAA;;IACE,QAAI,KAAK/B,KAAT,EAAgB;IACd;IACD;;IAED,QAAM9D,UAAU,GAAG,KAAK2B,WAAxB;IACA,QAAIgD,EAAJ;;IAEA,QAAI9E,QAAQ,CAACG,UAAD,CAAZ,EAA0B;IACxB2E,MAAAA,EAAE,GAAGmB,QAAQ,CAACC,aAAT,CAAoC/F,UAApC,CAAL;IACD,KAFD,MAEO,IAAIA,UAAU,YAAYgG,OAA1B,EAAmC;IACxCrB,MAAAA,EAAE,GAAG3E,UAAL;IACD,KAFM,MAEA,IAAI,WAAWA,UAAX,IAAyB,aAAaA,UAA1C,EAAsD;IAC3D2E,MAAAA,EAAE,GAAG3E,UAAU,CAACnD,KAAX,IAAqBmD,UAAU,CAAC1B,OAArC;IACD;;IAED,SAAK4F,kBAAL,GAA0BS,EAA1B;IACA,QAAIsB,MAAM,GAAG,KAAb;IACA,QAAMhC,iBAAiB,GAAG,KAAKC,kBAA/B;IACA,QAAMjE,OAAO,GAAG,KAAKoB,QAArB;IACA,QAAM6E,IAAI,GAAG,IAAIC,IAAJ,CAAS;IACpBnC,MAAAA,MAAM,EAAE;IACNoC,QAAAA,KAAK,EAAE,CAAC,CAACC,QAAF,EAAYA,QAAZ;IADD;IADY,KAAT,EAIV;IACDC,MAAAA,YAAY,EAAE,KADb;IAEDC,MAAAA,KAAK,EAAE,CAFN;IAGDC,MAAAA,MAAM,EAAEvG,OAAO,CAACuG;IAHf,KAJU,EAQV;IACDxC,MAAAA,MAAM,EAAE;IADP,KARU,CAAb;IAWA,QAAIyC,MAAM,GAAG,KAAb;IAEAP,IAAAA,IAAI,CAAC7I,EAAL,CAAQ;IACN,cAAQ,UAAAgD,CAAA;IACNoG,QAAAA,MAAM,GAAG,IAAT;IACAR,QAAAA,MAAM,GAAG,KAAT;;IACA,YAAMS,WAAW,GAAGlH,KAAI,CAACmH,eAAL,CAAqBtG,CAArB,CAApB;;IAEA,YAAI,CAACqG,WAAL,EAAkB;IAChB;IACD;;IACD,YAAIzG,OAAO,CAACkB,cAAZ,EAA4B;IAC1BuF,UAAAA,WAAW,CAACvF,cAAZ;IACD;;IACD,YAAIlB,OAAO,CAAC2G,kBAAZ,EAAgC;IAC9BpH,UAAAA,KAAI,CAACqH,aAAL;IACD;IACF,OAfK;IAgBN,gBAAU,UAAAxG,CAAA;IACR,YAAMqG,WAAW,GAAGlH,KAAI,CAACmH,eAAL,CAAqBtG,CAArB,CAApB;;IACA,YAAIqG,WAAW,IAAI,CAACD,MAApB,EAA4B;IAC1B;IACD;;IACD,YAAIxG,OAAO,CAACuB,YAAR,IAAwBhC,KAAI,CAACsH,aAAL,CAAmBJ,WAAnB,CAA5B,EAA6D;IAC3D;IACD;;IACDlH,QAAAA,KAAI,CAACuH,aAAL,GAAqB,CAAC,CAACL,WAAF,IAAiBA,WAAW,CAACM,IAAZ,KAAqB,OAA3D;IACAxH,QAAAA,KAAI,CAACyH,YAAL,GAAoB,CAAC,CAACR,MAAtB;IACAR,QAAAA,MAAM,GAAG,IAAT;IACA,YAAMjC,MAAM,GAAG3D,CAAC,CAAC6G,KAAF,CAAQlD,MAAvB;;IAEA,YAAI/D,OAAO,CAACqB,UAAZ,EAAwB;IACtB2C,UAAAA,iBAAiB,CAACkD,UAAlB,IAAgCnD,MAAhC;IACD,SAFD,MAEO;IACLC,UAAAA,iBAAiB,CAACmD,SAAlB,IAA+BpD,MAA/B;IACD;;IACD,YAAI/D,OAAO,CAACuG,MAAZ,EAAoB;IAClBhH,UAAAA,KAAI,CAAC6H,gBAAL,CAAsBX,WAAtB;IACD;IACF,OArCK;IAsCN,iBAAW,UAAArG,CAAA;IACT,YAAI,CAAC4F,MAAL,EAAa;IACX5F,UAAAA,CAAC,CAACiH,KAAF,cAAajH,CAAC,CAACkH,QAAf,EAA0B,CAA1B;;IACA/H,UAAAA,KAAI,CAAC4B,YAAL;IACD;;IACD6E,QAAAA,MAAM,GAAG,KAAT;IACD;IA5CK,KAAR;IA+CA,SAAKnC,KAAL,GAAaoC,IAAb;;IACA,QAAIjG,OAAO,CAACsB,OAAZ,EAAqB;IACnB2E,MAAAA,IAAI,CAACsB,OAAL,CAAavH,OAAO,CAACqB,UAAR,GAAqB,CAAC,QAAD,EAAW,EAAX,CAArB,GAAsC,CAAC,EAAD,EAAK,QAAL,CAAnD,EAAmE,IAAImG,QAAJ,CAAaxD,iBAAb,EAAgC;IACjGyD,QAAAA,SAAS,EAAE,CAAC,OAAD,CADsF;IAEjGC,QAAAA,WAAW,EAAE;IAFoF,OAAhC,CAAnE;IAID;;IACD,QAAI1H,OAAO,CAACuB,YAAZ,EAA0B;IACxB0E,MAAAA,IAAI,CAACsB,OAAL,CAAavH,OAAO,CAACqB,UAAR,GAAqB,CAAC,QAAD,EAAW,EAAX,CAArB,GAAsC,CAAC,EAAD,EAAK,QAAL,CAAnD,EAAmE,IAAIsG,UAAJ,CAAe3D,iBAAf,EAAkC;IACnG4D,QAAAA,aAAa,EAAE;IADoF,OAAlC,CAAnE;IAGD;;IACD5D,IAAAA,iBAAiB,CAAC6D,gBAAlB,CAAmC,QAAnC,EAA6C,KAAKjC,SAAlD;IACArJ,IAAAA,MAAM,CAACsL,gBAAP,CAAwB,QAAxB,EAAkC,KAAKC,MAAvC;IAEA,SAAKA,MAAL;IACD,GAhGM;IAiGP;;;;;;IAIO,iBAAA,GAAP;;;IACE,UAAA,KAAKjE,KAAL,UAAA,iBAAA,SAAA,MAAYkE,SAAZ;IACA,SAAKvI,WAAL;IACA,UAAA,KAAKyE,kBAAL,UAAA,iBAAA,SAAA,MAAyB+D,oBAAoB,UAAU,KAAKpC,UAA5D;IACArJ,IAAAA,MAAM,CAACyL,mBAAP,CAA2B,QAA3B,EAAqC,KAAKF,MAA1C;IACA,SAAKzK,GAAL;IACD,GANM;;IAOC,wBAAA,GAAR;IACE,QAAMgE,UAAU,GAAG,KAAKD,QAAL,CAAcC,UAAjC;IACA,QAAM2C,iBAAiB,GAAG,KAAKC,kBAA/B;IAEA,SAAKrD,IAAL,GAAYuC,IAAI,CAAC8E,GAAL,CACV,KAAKvH,WAAL,GAAmB,KAAKF,KADd,EAEVa,UAAU,GAAG2C,iBAAiB,CAACkD,UAArB,GAAkClD,iBAAiB,CAACmD,SAFpD,CAAZ;IAID,GARO;;IASA,kBAAA,GAAR,UAAiBrF,OAAjB;IACE,QAAMT,UAAU,GAAG,KAAKD,QAAL,CAAcC,UAAjC;IAEA,WAAO;IACLS,MAAAA,OAAO,SADF;IAELnB,MAAAA,GAAG,EAAEU,UAAU,GAAGS,OAAO,CAACoG,UAAX,GAAwBpG,OAAO,CAACqG,SAF1C;IAGL5H,MAAAA,IAAI,EAAEc,UAAU,GAAGS,OAAO,CAACsG,WAAX,GAAyBtG,OAAO,CAACuG;IAH5C,KAAP;IAKD,GARO;;IASA,yBAAA,GAAR,UAAwBjI,CAAxB;;;IACE,WAAO,CAAA,MAAAA,CAAC,SAAD,IAAAA,CAAC,WAAD,SAAA,GAAAA,CAAC,CAAEkI,UAAH,UAAA,iBAAA,SAAA,MAAeC,QAAf,IAA0B,MAAAnI,CAAC,CAACkI,UAAF,UAAA,iBAAA,SAAA,MAAcC,QAAxC,GAAmDnI,CAAC,SAAD,IAAAA,CAAC,WAAD,SAAA,GAAAA,CAAC,CAAEkI,UAA7D;IACD,GAFO;;IAGA,2BAAA,GAAR,UAA0BvF,IAA1B,EAA8C/C,OAA9C;IACE,QAAMO,IAAI,GAAG,KAAKC,KAAlB;IACA,QAAMgI,KAAK,GAAGxI,OAAO,CAACwI,KAAR,IAAiB,OAA/B;IACA,QAAMC,OAAO,GAAGzI,OAAO,CAAC0I,MAAR,IAAkB,CAAlC;IACA,QAAMC,OAAO,GAAG5F,IAAK,CAACpC,GAAtB;IACA,QAAMqC,QAAQ,GAAGD,IAAK,CAACxC,IAAvB;IACA,QAAIqI,SAAS,GAAG,CAAhB;;IAEA,QAAIJ,KAAK,KAAK,OAAd,EAAuB;IACrBI,MAAAA,SAAS,GAAGD,OAAO,GAAGF,OAAtB;IACD,KAFD,MAEO,IAAID,KAAK,KAAK,KAAd,EAAqB;IAC1BI,MAAAA,SAAS,GAAGD,OAAO,GAAG3F,QAAV,GAAqBzC,IAArB,GAA4BkI,OAAxC;IACD,KAFM,MAEA,IAAID,KAAK,KAAK,QAAd,EAAwB;IAC7BI,MAAAA,SAAS,GAAGD,OAAO,GAAG3F,QAAQ,GAAG,CAArB,GAAyBzC,IAAI,GAAG,CAAhC,GAAoCkI,OAAhD;IACD;;IACD,WAAOG,SAAP;IACD,GAhBO;;IAiBA,uBAAA,GAAR,UAAsBnC,WAAtB;IACE,WAAO,CAAC,CAACA,WAAF,IAAiB,CAAAA,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAEM,IAAb,MAAsB,OAAvC,KAAkDN,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAEoC,MAA/D,MAAyEpC,WAAW,SAAX,IAAAA,WAAW,WAAX,SAAA,GAAAA,WAAW,CAAEqC,MAAtF,CAAP;IACD,GAFO;;IAGA,0BAAA,GAAR,UAAyBrC,WAAzB;IACE,QAAI,KAAK5F,YAAL,IAAqB,KAAKE,UAA9B,EAA0C;IACxC0F,MAAAA,WAAW,CAACsC,4BAAZ,GAA2C,KAA3C;IACD;IACF,GAJO;;IAyDA,sBAAA,GAAR;IACExM,IAAAA,MAAM,CAACyL,mBAAP,CAA2B,OAA3B,EAAoC,KAAKgB,eAAzC,EAA0D,IAA1D;IACD,GAFO;;IAGA,uBAAA,GAAR;IACEzM,IAAAA,MAAM,CAACsL,gBAAP,CAAwB,OAAxB,EAAiC,KAAKmB,eAAtC,EAAuD,IAAvD;IACD,GAFO;;IAGA,yBAAA,GAAR;IAAA,oBAAA;;IACE,QAAI,CAAC,KAAKC,YAAV,EAAwB;IACtB;;;;;IAKA,WAAK/L,OAAL,CAAa,aAAb;IACD;;IACDX,IAAAA,MAAM,CAAC2M,YAAP,CAAoB,KAAKD,YAAzB;IACA,SAAKA,YAAL,GAAoB1M,MAAM,CAAC4M,UAAP,CAAkB;IACpC5J,MAAAA,KAAI,CAAC0J,YAAL,GAAoB,CAApB;IACA;;;;;;;IAMA1J,MAAAA,KAAI,CAACrC,OAAL,CAAa,cAAb,EAA6B;IAC3BkM,QAAAA,YAAY,EAAE7J,KAAI,CAACuH,aADQ;IAE3BuC,QAAAA,SAAS,EAAE9J,KAAI,CAACuH,aAAL,IAAsB,CAACvH,KAAI,CAACyH;IAFZ,OAA7B;;IAKAzH,MAAAA,KAAI,CAACuH,aAAL,GAAqB,KAArB;IACAvH,MAAAA,KAAI,CAACyH,YAAL,GAAoB,KAApB;IACD,KAfmB,EAejB,KAAK5F,QAAL,CAAcK,cAfG,CAApB;IAgBD,GA1BO;;IAlfkB6H,EAAAA,YAAzB1K,QAAQ,CAAC,cAAD,gDAAiB;;IAiBF0K,EAAAA,YAAvB1K,QAAQ,CAAC,YAAD,8CAAe;;IAiBD0K,EAAAA,YAAtB1K,QAAQ,CAAC,WAAD,uCAAc;;IA/DnB2K,EAAAA,QAAQ,eADbpK,oBACKoK,SAAA;IA0iBN,iBAAA;IAAC,EA1iBsB1M,UAAvB;;ICrCA;;;;;AAKA,IAAO,IAAM2M,gBAAgB,GAAG,CAC9B,QAD8B,EAE9B,aAF8B,EAG9B,UAH8B,EAI9B,UAJ8B,EAK9B,UAL8B,EAM9B,gBAN8B,EAO9B,UAP8B,EAQ9B,iBAR8B,EAS9B,aAT8B,EAU9B,MAV8B,CAAzB;AAaP,IAAO,IAAMC,eAAe,GAAG,CAC7B,YAD6B,EAE7B,UAF6B,EAG7B,YAH6B,EAI7B,UAJ6B,EAK7B,aAL6B,EAM7B,cAN6B,CAAxB;AASP,IAAO,IAAMC,uBAAuB,GAAG;IACrC,kBAAgB,KADqB;IAErC,gBAAc,KAFuB;IAGrC,eAAa;IAHwB,CAAhC;;ICXA,IAAMC,iBAAiB,GAM1B;IACFC,EAAAA,KAAK,EAAEF,uBADL;IAEF1L,EAAAA,OAAO,EAAEwL,gBAFP;IAGFK,EAAAA,MAAM,EAAEJ,eAHN;IAIFlL,EAAAA,QAAQ,YAACuL;IACP,WAAO,IAAIP,QAAJ,CAAaO,IAAI,CAACC,SAAlB,wBAAkCD,IAAI,CAACE;IAAOxI,MAAAA,QAAQ,EAAE;UAAxD,CAAP;IACD,GANC;IAOFG,EAAAA,IAAI,YAACpD,UAAUuL;IACb,QAAIA,IAAI,CAACE,KAAL,CAAWxI,QAAX,KAAwB,KAA5B,EAAmC;IACjCjD,MAAAA,QAAQ,CAACoD,IAAT;IACD;IACF,GAXC;IAYFvE,EAAAA,EAAE,YAACmB,UAAUL,MAAMf;IACjBoB,IAAAA,QAAQ,CAACnB,EAAT,CAAYc,IAAZ,EAAkBf,QAAlB;IACD,GAdC;IAeFE,EAAAA,GAAG,YAACkB,UAAUL,MAAMf;IAClBoB,IAAAA,QAAQ,CAAClB,GAAT,CAAaa,IAAb,EAAmBf,QAAnB;IACD,GAjBC;IAkBF4K,EAAAA,OAAO,YAACxJ;IACNA,IAAAA,QAAQ,CAACwJ,OAAT;IACD;IApBC,CANG;;IChBP;;;;;;;;;;;;;;;;;;;;;;;;ICAA;;;;;AAKA;IAEA,KAAK,IAAM7J,IAAX,IAAmB+L,OAAnB,EAA4B;IACzBV,EAAAA,QAAgB,CAACrL,IAAD,CAAhB,GAA0B+L,OAAe,CAAC/L,IAAD,CAAzC;IACF;;;;;;;;"}